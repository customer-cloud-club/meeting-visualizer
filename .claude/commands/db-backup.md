---
description: データベースバックアップ - DB定期バックアップ実行
---

# /db-backup - データベースバックアップ

データベースのバックアップを作成します。

## 使い方

```bash
# デフォルトバックアップ
/db-backup

# 特定環境のバックアップ
/db-backup --environment=production

# 圧縮バックアップ
/db-backup --compress

# S3へアップロード
/db-backup --upload
```

## 機能

1. **フルバックアップ**
   - 全テーブルのバックアップ
   - スキーマ定義のバックアップ

2. **増分バックアップ**
   - 変更分のみバックアップ
   - ディスク容量の節約

3. **自動アップロード**
   - S3へのアップロード
   - バックアップ世代管理

## 実行例

```
データベースバックアップ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

環境: production
データベース: PostgreSQL 14.5
サイズ: 2.3 GB

[1/4] バックアップ作成中...
  ✓ データダンプ完了

[2/4] 圧縮中...
  ✓ gzip圧縮完了 (2.3GB → 450MB)

[3/4] S3アップロード中...
  ✓ s3://ccagi-backups/db-backup-2025-12-04.sql.gz

[4/4] 世代管理...
  ✓ 古いバックアップ削除 (30日以上前)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✓ バックアップ完了

バックアップファイル:
  ローカル: ./backups/db-backup-2025-12-04.sql.gz
  S3: s3://ccagi-backups/db-backup-2025-12-04.sql.gz
  サイズ: 450 MB
  作成日時: 2025-12-04 15:30:00
```

## 復元方法

```bash
# バックアップから復元
gunzip < ./backups/db-backup-2025-12-04.sql.gz | psql database_name
```

## 関連コマンド

- `/deploy-status` - 環境状態確認
- `/health-check` - ヘルスチェック
