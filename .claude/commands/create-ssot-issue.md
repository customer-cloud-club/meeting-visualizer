---
description: SSOT Issueã‚’ä½œæˆï¼ˆæ–°è¦ãƒ»æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¯¾å¿œï¼‰
allowed-tools: Bash, Read, Write, Grep, Glob, Edit
---

# Create SSOT Issue Command

SSOT (Single Source of Truth) Issue ã‚’ä½œæˆã—ã€`.ccagi.yml` ã«è¨˜éŒ²ã—ã¾ã™ã€‚

## ä½¿ç”¨æ–¹æ³•

```bash
# æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’æŒ‡å®šï¼‰
/create-ssot-issue my-project

# æ—¢å­˜è¦ä»¶å®šç¾©æ›¸ã‹ã‚‰ä½œæˆ
/create-ssot-issue --from-doc ./docs/requirements/REQUIREMENTS.md

# æ—¢å­˜GitHub Issueã‹ã‚‰ä½œæˆ
/create-ssot-issue --from-issue 123
```

## ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

å¼•æ•°: `$ARGUMENTS`

- `<project-name>`: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
- `--from-doc <path>`: ãƒ­ãƒ¼ã‚«ãƒ«è¦ä»¶å®šç¾©æ›¸ã®ãƒ‘ã‚¹
- `--from-issue <number|url>`: æ—¢å­˜GitHub Issueç•ªå·ã¾ãŸã¯URL

## å®Ÿè¡Œæ‰‹é †

### Step 1: å¼•æ•°è§£æ

```bash
ARGS="$ARGUMENTS"

# ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®š
if [[ "$ARGS" =~ --from-doc ]]; then
  MODE="from-doc"
  DOC_PATH=$(echo "$ARGS" | sed 's/.*--from-doc[[:space:]]*//' | awk '{print $1}')
elif [[ "$ARGS" =~ --from-issue ]]; then
  MODE="from-issue"
  ISSUE_REF=$(echo "$ARGS" | sed 's/.*--from-issue[[:space:]]*//' | awk '{print $1}')
else
  MODE="new"
  PROJECT_NAME="$ARGS"
fi
```

### Step 2: æ—¢å­˜SSOT Issueã®ç¢ºèª

```bash
# æ—¢ã«SSOT IssueãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
EXISTING=$(gh issue list --label "SSOT" --state open --json number,title --jq '.[0].number // empty')

if [ -n "$EXISTING" ]; then
  echo "âš ï¸ æ—¢å­˜ã®SSOT Issue #${EXISTING} ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ"
  echo "â†’ æ–°ã—ãä½œæˆã™ã‚‹å ´åˆã¯æ—¢å­˜ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã—ã¦ãã ã•ã„"
  # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹
fi
```

### Step 3: SSOT Issueä½œæˆ

#### ãƒ‘ã‚¿ãƒ¼ãƒ³ A: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

```bash
if [ "$MODE" = "new" ]; then
  SSOT_ISSUE=$(gh issue create \
    --title "[SSOT] ${PROJECT_NAME} - Document Registry" \
    --body "$(cat <<'EOF'
# ğŸ“‹ SSOT Document Registry

ã“ã®Issueã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®ãƒªãƒ³ã‚¯ã¨é€²æ—ã‚’ç®¡ç†ã—ã¾ã™ã€‚

## ğŸ“Š é€²æ—çŠ¶æ³

| Phase | Status | Updated |
|-------|--------|---------|
| Phase 1: Requirements | â³ | - |
| Phase 2: Design | â³ | - |
| Phase 3: Planning | â³ | - |
| Phase 4: Implementation | â³ | - |
| Phase 5: Testing | â³ | - |
| Phase 6: Documentation | â³ | - |
| Phase 7: Deployment | â³ | - |
| Phase 8: Platform | â³ | - |

## ğŸ“ ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### Phase 1: Requirements
<!-- PHASE_1_DOCS -->

### Phase 2: Design
<!-- PHASE_2_DOCS -->

### Phase 3: Planning
<!-- PHASE_3_DOCS -->

### Phase 4: Implementation
<!-- PHASE_4_DOCS -->

### Phase 5: Testing
<!-- PHASE_5_DOCS -->

### Phase 6: Documentation
<!-- PHASE_6_DOCS -->

### Phase 7: Deployment
<!-- PHASE_7_DOCS -->

### Phase 8: Platform
<!-- PHASE_8_DOCS -->

## ğŸ’¬ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯ã“ã®Issueã®ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã¾ã™ã€‚
å„ãƒ•ã‚§ãƒ¼ã‚ºã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã«è‡ªå‹•ã§å‚ç…§ã•ã‚Œã¾ã™ã€‚

---
ğŸ¤– Generated by CCAGI SDK
EOF
)" \
    --label "SSOT,ğŸ¤– automated" | grep -oE '[0-9]+$')
fi
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³ B: æ—¢å­˜è¦ä»¶å®šç¾©æ›¸ã‹ã‚‰

```bash
if [ "$MODE" = "from-doc" ]; then
  # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿
  if [ ! -f "$DOC_PATH" ]; then
    echo "âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $DOC_PATH"
    exit 1
  fi

  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’æŠ½å‡ºï¼ˆãƒ•ã‚¡ã‚¤ãƒ«åã¾ãŸã¯ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰ï¼‰
  PROJECT_NAME=$(basename "$(dirname "$DOC_PATH")" | sed 's/-/ /g')

  # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒªãƒ³ã‚¯ã‚’å«ã‚ã¦Issueä½œæˆ
  SSOT_ISSUE=$(gh issue create \
    --title "[SSOT] ${PROJECT_NAME} - Document Registry" \
    --body "$(cat <<EOF
# ğŸ“‹ SSOT Document Registry

## ğŸ“Š é€²æ—çŠ¶æ³

| Phase | Status | Updated |
|-------|--------|---------|
| Phase 1: Requirements | âœ… | $(date '+%Y-%m-%d') |
| Phase 2: Design | â³ | - |
| Phase 3: Planning | â³ | - |
| Phase 4: Implementation | â³ | - |
| Phase 5: Testing | â³ | - |
| Phase 6: Documentation | â³ | - |
| Phase 7: Deployment | â³ | - |
| Phase 8: Platform | â³ | - |

## ğŸ“ ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### Phase 1: Requirements
- [$(basename "$DOC_PATH")]($DOC_PATH) - æ—¢å­˜è¦ä»¶å®šç¾©æ›¸

<!-- PHASE_1_DOCS -->

### Phase 2: Design
<!-- PHASE_2_DOCS -->

(ä»¥ä¸‹åŒæ§˜)

---
ğŸ¤– Generated by CCAGI SDK (from existing document)
EOF
)" \
    --label "SSOT,requirements,ğŸ¤– automated" | grep -oE '[0-9]+$')
fi
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³ C: æ—¢å­˜GitHub Issueã‹ã‚‰

```bash
if [ "$MODE" = "from-issue" ]; then
  # Issueç•ªå·ã‚’æŠ½å‡º
  if [[ "$ISSUE_REF" =~ ^[0-9]+$ ]]; then
    SOURCE_ISSUE=$ISSUE_REF
  else
    # URLã‹ã‚‰ç•ªå·ã‚’æŠ½å‡º
    SOURCE_ISSUE=$(echo "$ISSUE_REF" | grep -oE '[0-9]+$')
  fi

  # å…ƒIssueã®å†…å®¹ã‚’å–å¾—
  SOURCE_TITLE=$(gh issue view $SOURCE_ISSUE --json title --jq '.title')
  SOURCE_BODY=$(gh issue view $SOURCE_ISSUE --json body --jq '.body')

  # SSOT Issueä½œæˆï¼ˆå…ƒIssueã‚’ãƒªãƒ³ã‚¯ï¼‰
  SSOT_ISSUE=$(gh issue create \
    --title "[SSOT] ${SOURCE_TITLE} - Document Registry" \
    --body "$(cat <<EOF
# ğŸ“‹ SSOT Document Registry

**ã‚½ãƒ¼ã‚¹Issue**: #${SOURCE_ISSUE}

## ğŸ“Š é€²æ—çŠ¶æ³

| Phase | Status | Updated |
|-------|--------|---------|
| Phase 1: Requirements | ğŸ”„ | $(date '+%Y-%m-%d') |
| Phase 2-8 ... | â³ | - |

## ğŸ“ å…ƒIssueå†…å®¹

${SOURCE_BODY}

## ğŸ“ ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### Phase 1: Requirements
- å…ƒIssue #${SOURCE_ISSUE} ã‹ã‚‰ç§»è¡Œ

<!-- PHASE_1_DOCS -->

---
ğŸ¤– Generated by CCAGI SDK (from Issue #${SOURCE_ISSUE})
EOF
)" \
    --label "SSOT,ğŸ¤– automated" | grep -oE '[0-9]+$')

  # å…ƒIssueã«ãƒªãƒ³ã‚¯ã‚’è¿½åŠ 
  gh issue comment $SOURCE_ISSUE --body "ğŸ“ SSOT Issue #${SSOT_ISSUE} ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ä»¥é™ã®é€²æ—ç®¡ç†ã¯ãã¡ã‚‰ã§è¡Œã„ã¾ã™ã€‚"
fi
```

### Step 4: .ccagi.yml ã«è¨˜éŒ²

```bash
# .ccagi.yml ã«SSOTè¨­å®šã‚’è¿½åŠ /æ›´æ–°
if grep -q "^ssot:" .ccagi.yml 2>/dev/null; then
  # æ—¢å­˜ã®ssotã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°
  sed -i '' "s/issue_number:.*/issue_number: ${SSOT_ISSUE}/" .ccagi.yml
else
  # ssotã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
  cat >> .ccagi.yml <<EOF

# ========================================
# SSOT (Single Source of Truth) è¨­å®š
# ========================================
ssot:
  issue_number: ${SSOT_ISSUE}
  project_name: "${PROJECT_NAME}"
  created_at: "$(date '+%Y-%m-%d')"
EOF
fi

echo "âœ… .ccagi.yml ã‚’æ›´æ–°ã—ã¾ã—ãŸ"
```

### Step 5: å®Œäº†å ±å‘Š

```
âœ… SSOT Issue ã‚’ä½œæˆã—ã¾ã—ãŸ

Issueç•ªå·: #${SSOT_ISSUE}
URL: https://github.com/<owner>/<repo>/issues/${SSOT_ISSUE}
ãƒ¢ãƒ¼ãƒ‰: ${MODE}

.ccagi.yml ã«è¨˜éŒ²æ¸ˆã¿ã€‚
ä»Šå¾Œã®ãƒ•ã‚§ãƒ¼ã‚ºã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•å‚ç…§ã•ã‚Œã¾ã™ã€‚

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:
  /generate-requirements <url>  # è¦ä»¶ç”Ÿæˆï¼ˆPhase 1ã¸ï¼‰
  /user-feedback <å†…å®¹>         # ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¨˜éŒ²
```

## é–¢é€£ã‚³ãƒãƒ³ãƒ‰

- [/generate-requirements](./generate-requirements.md) - è¦ä»¶ç”Ÿæˆï¼ˆSSOTè‡ªå‹•ä½œæˆä»˜ãï¼‰
- [/user-feedback](./user-feedback.md) - ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¨˜éŒ²

---
ğŸ¤– CCAGI SDK - SSOT Issue Management
